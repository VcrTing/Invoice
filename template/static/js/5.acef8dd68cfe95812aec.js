webpackJsonp([5],{BX0g:function(t,e){},PvKo:function(t,e){},UEnp:function(t,e){},YQkM:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("NAQQ"),n=i("/xUl"),s=i("3MUH"),r=i("gS0T"),o=i("UQ+I"),l=i("0ti1"),c=i("gIGi"),d={components:{SortOption:o.a,SearchOption:l.a,ClearFilterOption:c.a},name:"FreightViewTop",props:{freights:{type:Array}},methods:{openSearch:function(){a.a.showModal("freightSearchModal")},clearFilter:function(){this.$emit("clearFilter_Father")}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"row of-visible"},[t._m(0),t._v(" "),i("div",{staticClass:"col-sm-6 pt-1 text-right of-visible"},[i("sort-option",{attrs:{_list:t.freights}}),t._v(" "),i("search-option",{on:{openSearch_Father:t.openSearch}}),t._v(" "),i("clear-filter-option",{on:{clearCondition_Father:t.clearFilter}})],1)]),t._v(" "),t._m(1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-sm-6 pt-2"},[e("h5",{staticClass:"fw-none"},[this._v("\n        全部\n      ")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("table",{staticClass:"table"},[i("tr",[i("td",{staticClass:"text-accent",attrs:{width:"5%"}},[t._v("#")]),t._v(" "),i("td",{attrs:{width:"10%"}},[t._v("編號")]),t._v(" "),i("td",{attrs:{width:"20%"}},[t._v("產品描述")]),t._v(" "),i("td",{attrs:{width:"15%"}},[t._v("價格")]),t._v(" "),i("td",{attrs:{width:"10%"}},[t._v("單位")]),t._v(" "),i("td",{attrs:{width:"30%"}},[t._v("標簽")]),t._v(" "),i("td",{attrs:{width:"10%"}})])])}]};var h=i("VU/8")(d,u,!1,function(t){i("e1Ak")},"data-v-d0492cbc",null).exports,m=(i("7t+N"),i("0jG4"),i("5nBN")),f=i.n(m),p=i("z8RL"),v=i("SiM+"),_={name:"FreightViewBody",components:{Pencil:p.a,Remove:v.a},props:{freights:{type:Array}},methods:{unit:function(t){return f.a.ser_unit(t)},option:function(t,e){this.$emit("option_Father",t,e)}}},g={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("table",{staticClass:"table m-0 table-top-line-none"},t._l(t.freights,function(e,a){return i("tr",{key:e.id,attrs:{id:"freight_tr_"+e.id}},[i("td",{staticClass:"text-accent",attrs:{width:"5%"}},[t._v(t._s(a+1))]),t._v(" "),i("td",{attrs:{width:"10%"}},[t._v(t._s(e.num))]),t._v(" "),i("td",{attrs:{width:"20%"}},[t._v(t._s(e.named))]),t._v(" "),i("td",{attrs:{width:"15%"}},[t._v("$ "+t._s(e.price))]),t._v(" "),i("td",{attrs:{width:"10%"}},[t._v("  "+t._s(t.unit(e.unit)))]),t._v(" "),i("td",{attrs:{width:"30%"}},t._l(e.tag,function(e){return i("div",{key:e.id,staticClass:"tag tag-table tag-table-fix",style:{background:e.color}},[t._v("\n        "+t._s(e.named)+"\n      ")])}),0),t._v(" "),i("td",{attrs:{width:"10%"}},[i("i",{staticClass:"float-right",on:{click:function(i){return t.option(e.id,"trash")}}},[i("remove")],1),t._v(" "),i("i",{staticClass:"float-right",on:{click:function(i){return t.option(e.id,"update")}}},[i("pencil")],1)])])}),0)},staticRenderFns:[]};var F=i("VU/8")(_,g,!1,function(t){i("PvKo")},"data-v-5dc16bc2",null).exports,y=i("WNq0"),b={components:{PagerOption:i("B4CL").a},name:"FreightViewFooter",props:{_pageLink:{type:Object}},methods:{_loadData:function(t){this.$emit("_loadData_Father",t)}}},C={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-6"}),this._v(" "),e("div",{staticClass:"col-sm-6 text-right"},[e("pager-option",{attrs:{_page:this._pageLink},on:{loadData_Father:this._loadData}})],1)])},staticRenderFns:[]};var w=i("VU/8")(b,C,!1,function(t){i("s/GW")},"data-v-cee68856",null).exports,x=i("cpG1"),L=i("HT3s"),P=i("U5hB"),U={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"fixed-plus-btn hand tool-tip",attrs:{"data-toggle":"tooltip","data-placement":"top",title:"新增"},on:{click:this.plusDone}})},staticRenderFns:[]};var k=i("VU/8")({name:"PlusFixed",methods:{plusDone:function(){this.$emit("plusDone_Father")}}},U,!1,function(t){i("UEnp")},null,null).exports,R=i("//Fk"),D=i.n(R),$=i("BO1k"),T=i.n($),E=i("I76R"),M=i.n(E),V={name:"FreightPlusForm",props:{isPlus:{type:Boolean}},data:function(){return{select:[],tags:[],orderNum:"",num:"",tip_num:"",named:"",tip_named:"",price:"",tip_price:"",unit:0,tip_tag:"",activeId:0}},computed:{units:function(){return f.a.unitList.map(function(t){return{flag:t[0],named:t[1]}})}},mounted:function(){this.loadTag()},methods:{locationData:function(t){if(null!=t&&void 0!=t){if(this.named=t.named,this.price=t.price,this.unit=t.unit,this.num=t.num,this.select=[],this.orderNum=t.num,null!=t.tag&&void 0!=t.tag){var e=[],i=!0,n=!1,s=void 0;try{for(var r,o=T()(t.tag);!(i=(r=o.next()).done);i=!0){var l=r.value;e.push(l.id)}}catch(t){n=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(n)throw s}}var c=!0,d=!1,u=void 0;try{for(var h,m=T()(this.tags);!(c=(h=m.next()).done);c=!0){var f=h.value;a.a.inList(f.id,e)&&this.select.push(f.id)}}catch(t){d=!0,u=t}finally{try{!c&&m.return&&m.return()}finally{if(d)throw u}}}this.activeId=t.id}},loadTag:function(){var t=this;n.a.tag.getList_Tag({},!0).then(function(e){n.a.judge_response(e)&&(t.tags=e,t.select.push(e[0].id))})},inList:function(t,e){return a.a.inList(t,e)},tagChoise:function(t){var e=a.a.indexList(t,this.select);e>=0?this.select.length<=1?a.a.showToast("提示：請至少選擇壹個標簽。"):this.select.splice(e,1):this.select.push(t)},tipClose:function(t){var e=this;setTimeout(function(){"num"==t?e.tip_num="":"named"==t?e.tip_named="":"price"==t&&(e.tip_price="")},4200)},tipForm:function(t,e){var i="";1!=t&&(i=t),"num"==e?this.tip_num=i:"named"==e?this.tip_named=i:"price"==e&&(this.tip_price=i),this.tipClose(e)},validateForm:function(){var t=!0,e=M.a.val_empty(this.num,"貨號");return 1==e?(e=M.a.val_char(this.num,"貨號"),this.tipForm(e,"num")):this.tipForm(e,"num"),1!=e&&(t=!1),1==(e=M.a.val_empty(this.named,"描述"))?(e=M.a.val_char(this.named,"描述"),this.tipForm(e,"named")):this.tipForm(e,"named"),1!=e&&(t=!1),1==(e=M.a.val_empty(this.price,"零售價"))?(e=M.a.val_char_price(this.price,"零售價"),this.tipForm(e,"price")):this.tipForm(e,"price"),1!=e&&(t=!1),t},_validateSame:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i={num:t.num};return new D.a(function(t,s){n.a.freight.getList_Freight(i,!0).then(function(i){if(i.length>0)if(0==e)t(!1);else{var a=[],n=!0,s=!1,r=void 0;try{for(var o,l=T()(i);!(n=(o=l.next()).done);n=!0){var c=o.value;c.id!=e&&a.push(c)}}catch(t){s=!0,r=t}finally{try{!n&&l.return&&l.return()}finally{if(s)throw r}}a.length>0&&t(!1)}t(!0)}).catch(function(t){s(!1),a.a.showToast("網絡連接失敗。")})})},_submit:function(t){var e=this;this.isPlus?this._validateSame(t).then(function(i){i?e.$emit("plus_Father",t):a.a.showToast("已存在相同貨號的產品了。")}):this._validateSame(t,this.activeId).then(function(i){i?e.$emit("update_Father",t,e.activeId):a.a.showToast("這個貨號的產品已經存在了。")})},submitForm:function(){if(1==this.validateForm()){var t={num:this.num,named:this.named,price:this.price,unit:this.unit,tags:this.select.join(",")};this._submit(t)}}}},I={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"modal-form-wrapper"},[i("form",[i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"num"}},[t._v("貨號")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.num,expression:"num"}],staticClass:"form-control",attrs:{type:"text",id:"num",placeholder:"貨號"},domProps:{value:t.num},on:{input:function(e){e.target.composing||(t.num=e.target.value)}}}),t._v(" "),i("small",{staticClass:"form-text text-muted",attrs:{id:"numTip"}},[t._v(t._s(t.tip_num))])]),t._v(" "),i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"named"}},[t._v("描述")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.named,expression:"named"}],staticClass:"form-control",attrs:{type:"text",id:"named",placeholder:"描述"},domProps:{value:t.named},on:{input:function(e){e.target.composing||(t.named=e.target.value)}}}),t._v(" "),i("small",{staticClass:"form-text text-muted",attrs:{id:"numTip"}},[t._v(t._s(t.tip_named))])]),t._v(" "),i("div",{staticClass:"form-group row"},[i("div",{staticClass:"col-sm-4"},[i("label",{attrs:{for:"price"}},[t._v("零售價")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.price,expression:"price"}],staticClass:"form-control",attrs:{type:"text",id:"price",placeholder:"價格"},domProps:{value:t.price},on:{input:function(e){e.target.composing||(t.price=e.target.value)}}}),t._v(" "),i("small",{staticClass:"form-text text-muted",attrs:{id:"numTip"}},[t._v(t._s(t.tip_price))])]),t._v(" "),i("div",{staticClass:"col-sm-4"},[i("label",{attrs:{for:"unit"}},[t._v("單位")]),t._v(" "),i("select",{directives:[{name:"model",rawName:"v-model",value:t.unit,expression:"unit"}],staticClass:"form-control",attrs:{id:"unit"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.unit=e.target.multiple?i:i[0]}}},t._l(t.units,function(e){return i("option",{key:e.flag,domProps:{value:e.flag}},[t._v(t._s(e.named))])}),0)]),t._v(" "),i("div",{staticClass:"col-sm-4"})]),t._v(" "),i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"named"}},[t._v("標簽")]),t._v(" "),t.tags.length>0?i("div",{staticClass:"tag-wrapper"},t._l(t.tags,function(e){return i("div",{key:e.named,staticClass:"tag tag-def d-inline hand",class:{"tag-active":t.inList(e.id,t.select)},on:{click:function(i){return t.tagChoise(e.id)}}},[t._v("\n          "+t._s(e.named)+"\n        ")])}),0):t._e(),t._v(" "),i("small",{staticClass:"form-text text-muted",attrs:{id:"numTip"}},[t._v(t._s(t.tip_tag))])])])])},staticRenderFns:[]};var S=i("VU/8")(V,I,!1,function(t){i("dKQC")},"data-v-555ce4c4",null).exports,N={components:{FreightPlusForm:S},name:"FreightPlus",props:{freight:{type:Object}},methods:{submitFreightPlus:function(){this.$refs.plusForm.submitForm()},_signelRefreash:function(){this.$emit("signelRefreash_Father")},_plus:function(t){var e=this;n.a.freight.add(t).then(function(t){n.a.judge_response(t)&&(a.a.showToast("新增成功！！！",2100),setTimeout(function(){a.a.closeAllModal(),e._signelRefreash()},700))})}}},j={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal fade",attrs:{tabindex:"-1",role:"dialog",id:"freightPlusModal"}},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-body"},[e("freight-plus-form",{ref:"plusForm",attrs:{isPlus:!0,_freight:this.freight},on:{plus_Father:this._plus}})],1),this._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-main",on:{click:this.submitFreightPlus}},[this._v("保存")])])])])])},staticRenderFns:[]};var O=i("VU/8")(N,j,!1,function(t){i("vd5b")},"data-v-4a79f6b2",null).exports,A={name:"FreightUpdated",components:{FreightPlusForm:S},props:{freight:{type:Object}},methods:{submitFreightPlus:function(){this.$refs.updateFormREF.submitForm()},validateSame:function(t){return!0},update:function(t,e){var i=this;this.validateSame(t)&&n.a.freight.update(t,e).then(function(t){n.a.judge_response(t)&&(a.a.showToast("修改成功！！！",1900),setTimeout(function(){a.a.closeAllModal(),i.$emit("signelRefreash_Father")},700))})},locationUpdateData:function(t){this.$refs.updateFormREF.locationData(t)}}},B={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal fade",attrs:{tabindex:"-1",role:"dialog",id:"freightUpdateModal"}},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-body"},[e("freight-plus-form",{ref:"updateFormREF",attrs:{isPlus:!1},on:{update_Father:this.update}})],1),this._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-main",on:{click:this.submitFreightPlus}},[this._v("保存")])])])])])},staticRenderFns:[]};var Q=i("VU/8")(A,B,!1,function(t){i("BX0g")},"data-v-09b793aa",null).exports,G={components:{FullHeightLayout:r.a,FreightViewTop:h,FreightViewBody:F,FreightViewSearch:y.a,FreightViewFooter:w,Trash:L.a,Empty:x.a,Loading:P.a,PlusFixed:k,FreightPlus:O,FreightUpdated:Q},name:"FreightView",data:function(){return{freightList:[],pageLink:{next:"",previous:"",count:0,offsetNow:0,limit:100},isLoading:!0,activeId:0,activeFreight:null,activeURL:""}},mounted:function(){this.loadData()},methods:{loadData:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null==t&&(t=s.a.buildFirstPagerUrl(n.a.freight.url,i,{offset:0,limit:this.pageLink.limit})),n.a.freight.getListPage(t).then(function(i){e.activeURL=t,e.freightList=i.results,e.pageLink=s.a.buildPageLink(t,i.count,100,i.next,i.previous),e.isLoading=!1}).catch(function(t){a.a.showToast("網絡連接失敗。")})},plusDone:function(){a.a.showModal("freightPlusModal")},locationUpdateData:function(){this.loadData(this.activeURL)},clearFilter:function(){this.loadData()},option:function(t,e){var i=this;this.activeId=t,"trash"==e?a.a.showModal("trashModal"):"update"==e&&n.a.freight.getOne(t).then(function(t){n.a.judge_response(t)&&(i.activeFreight=t,i.$refs.freightUpdateREF.locationUpdateData(t),a.a.showModal("freightUpdateModal"))})},_trash:function(){var t=this,e=this;a.a.closeModal("trashModal"),null!=this.activeId&&this.activeId>0&&n.a.freight.trash(this.activeId).then(function(i){n.a.judge_response(i)&&(a.a.showToast("刪除成功！！"),a.a.hideEle("freight_tr_"+t.activeId),e.isLoading=!1)})}}},K={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("full-height-layout",[i("div",{attrs:{slot:"layout_title"},slot:"layout_title"},[t._v("產品")]),t._v(" "),i("freight-view-top",{attrs:{slot:"layout_inner_head",freights:t.freightList},on:{clearFilter_Father:t.clearFilter},slot:"layout_inner_head"}),t._v(" "),t.freightList.length>0?i("freight-view-body",{attrs:{slot:"layout_inner_body",freights:t.freightList},on:{option_Father:t.option},slot:"layout_inner_body"}):t.isLoading?i("loading",{attrs:{slot:"layout_inner_body"},slot:"layout_inner_body"}):i("empty",{attrs:{slot:"layout_inner_body"},slot:"layout_inner_body"}),t._v(" "),i("freight-view-footer",{attrs:{slot:"layout_footer",_pageLink:t.pageLink},on:{_loadData_Father:t.loadData},slot:"layout_footer"}),t._v(" "),i("div",{attrs:{slot:"layout_extra"},slot:"layout_extra"},[i("freight-view-search",{on:{loadData_Father:t.loadData}}),t._v(" "),i("trash",{on:{trashItem:t._trash}}),t._v(" "),i("plus-fixed",{on:{plusDone_Father:t.plusDone}}),t._v(" "),i("freight-plus",{on:{signelRefreash_Father:t.loadData}}),t._v(" "),i("freight-updated",{ref:"freightUpdateREF",attrs:{freight:t.activeFreight},on:{signelRefreash_Father:t.locationUpdateData}})],1)],1)},staticRenderFns:[]};var H=i("VU/8")(G,K,!1,function(t){i("tbEl")},"data-v-93d9ec32",null);e.default=H.exports},dKQC:function(t,e){},e1Ak:function(t,e){},gIGi:function(t,e,i){"use strict";i("NAQQ");var a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn btn-light btn-sm pb-0 float-right mr-2 tool-tip",attrs:{"data-toggle":"tooltip","data-placement":"top",title:"重新整理"},on:{click:this.clearCondition}},[e("i",{staticClass:"fa fa-refresh"})])},staticRenderFns:[]};var n=i("VU/8")({name:"ClearFilterOption",methods:{clearCondition:function(){this.$emit("clearCondition_Father")}}},a,!1,function(t){i("xpo1")},"data-v-3a774582",null);e.a=n.exports},"s/GW":function(t,e){},tbEl:function(t,e){},vd5b:function(t,e){},xpo1:function(t,e){}});
//# sourceMappingURL=5.acef8dd68cfe95812aec.js.map