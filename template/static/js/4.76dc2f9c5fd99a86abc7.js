webpackJsonp([4],{B4CL:function(t,e,a){"use strict";a("NAQQ"),a("5nBN");var i=a("3MUH"),n={name:"PageOption",props:{_page:{type:Object}},methods:{totalPage:function(){return i.a.getTotalPage(this._page.limit,this._page.count)},nowPage:function(){return i.a.getNowPage(this._page.offsetNow,this._page.limit)},pageOption:function(t){var e="";e=t?this._page.next:this._page.previous,this.$emit("loadData_Father",e)}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("button",{staticClass:"btn btn-sm btn-pager",on:{click:function(e){return t.pageOption(!1)}}},[t._v("上一頁")]),t._v(" "),a("div",{staticClass:"page-num-wrapper d-inline text-input"},[t._v("\n    "+t._s(t.nowPage())+"/"+t._s(t.totalPage())+"\n  ")]),t._v(" "),a("button",{staticClass:"btn btn-sm btn-pager",on:{click:function(e){return t.pageOption(!0)}}},[t._v("下一頁")])])},staticRenderFns:[]};var r=a("VU/8")(n,s,!1,function(t){a("gtvN")},"data-v-b7ef526e",null);e.a=r.exports},BX0g:function(t,e){},PvKo:function(t,e){},UEnp:function(t,e){},YQkM:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("NAQQ"),n=a("/xUl"),s=a("3MUH"),r=a("gS0T"),o=a("UQ+I"),l=a("0ti1"),c=a("gIGi"),u={components:{SortOption:o.a,SearchOption:l.a,ClearFilterOption:c.a},name:"FreightViewTop",props:{freights:{type:Array}},methods:{openSearch:function(){i.a.showModal("freightSearchModal")},clearFilter:function(){this.$emit("clearFilter_Father")}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"row of-visible"},[t._m(0),t._v(" "),a("div",{staticClass:"col-sm-6 pt-1 text-right of-visible"},[a("sort-option",{attrs:{_list:t.freights}}),t._v(" "),a("search-option",{on:{openSearch_Father:t.openSearch}}),t._v(" "),a("clear-filter-option",{on:{clearCondition_Father:t.clearFilter}})],1)]),t._v(" "),t._m(1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-sm-6 pt-2"},[e("h5",{staticClass:"fw-none"},[this._v("\n        全部\n      ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",{staticClass:"table"},[a("tr",[a("td",{staticClass:"text-accent",attrs:{width:"5%"}},[t._v("#")]),t._v(" "),a("td",{attrs:{width:"10%"}},[t._v("編號")]),t._v(" "),a("td",{attrs:{width:"20%"}},[t._v("產品描述")]),t._v(" "),a("td",{attrs:{width:"15%"}},[t._v("價格")]),t._v(" "),a("td",{attrs:{width:"10%"}},[t._v("單位")]),t._v(" "),a("td",{attrs:{width:"30%"}},[t._v("標簽")]),t._v(" "),a("td",{attrs:{width:"10%"}})])])}]};var h=a("VU/8")(u,d,!1,function(t){a("e1Ak")},"data-v-d0492cbc",null).exports,p=(a("7t+N"),a("0jG4"),a("5nBN")),v=a.n(p),f=a("z8RL"),m=a("SiM+"),_={name:"FreightViewBody",components:{Pencil:f.a,Remove:m.a},props:{freights:{type:Array}},methods:{unit:function(t){return v.a.ser_unit(t)},option:function(t,e){this.$emit("option_Father",t,e)}}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",{staticClass:"table m-0 table-top-line-none"},t._l(t.freights,function(e,i){return a("tr",{key:e.id,attrs:{id:"freight_tr_"+e.id}},[a("td",{staticClass:"text-accent",attrs:{width:"5%"}},[t._v(t._s(i+1))]),t._v(" "),a("td",{attrs:{width:"10%"}},[t._v(t._s(e.num))]),t._v(" "),a("td",{attrs:{width:"20%"}},[t._v(t._s(e.named))]),t._v(" "),a("td",{attrs:{width:"15%"}},[t._v("$ "+t._s(e.price))]),t._v(" "),a("td",{attrs:{width:"10%"}},[t._v("  "+t._s(t.unit(e.unit)))]),t._v(" "),a("td",{attrs:{width:"30%"}},t._l(e.tag,function(e){return a("div",{key:e.id,staticClass:"tag tag-table tag-table-fix",style:{background:e.color}},[t._v("\n        "+t._s(e.named)+"\n      ")])}),0),t._v(" "),a("td",{attrs:{width:"10%"}},[a("i",{staticClass:"float-right",on:{click:function(a){return t.option(e.id,"trash")}}},[a("remove")],1),t._v(" "),a("i",{staticClass:"float-right",on:{click:function(a){return t.option(e.id,"update")}}},[a("pencil")],1)])])}),0)},staticRenderFns:[]};var F=a("VU/8")(_,g,!1,function(t){a("PvKo")},"data-v-5dc16bc2",null).exports,b=a("WNq0"),y={components:{PagerOption:a("B4CL").a},name:"FreightViewFooter",props:{_pageLink:{type:Object}},methods:{_loadData:function(t){this.$emit("_loadData_Father",t)}}},C={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-6"}),this._v(" "),e("div",{staticClass:"col-sm-6 text-right"},[e("pager-option",{attrs:{_page:this._pageLink},on:{loadData_Father:this._loadData}})],1)])},staticRenderFns:[]};var w=a("VU/8")(y,C,!1,function(t){a("s/GW")},"data-v-cee68856",null).exports,x=a("cpG1"),P=a("HT3s"),L=a("U5hB"),U={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"fixed-plus-btn hand tool-tip",attrs:{"data-toggle":"tooltip","data-placement":"top",title:"新增"},on:{click:this.plusDone}})},staticRenderFns:[]};var k=a("VU/8")({name:"PlusFixed",methods:{plusDone:function(){this.$emit("plusDone_Father")}}},U,!1,function(t){a("UEnp")},null,null).exports,R=a("//Fk"),$=a.n(R),D=a("BO1k"),T=a.n(D),E=a("I76R"),M=a.n(E),N={name:"FreightPlusForm",props:{isPlus:{type:Boolean}},data:function(){return{select:[],tags:[],orderNum:"",num:"",tip_num:"",named:"",tip_named:"",price:"",tip_price:"",unit:0,tip_tag:"",activeId:0}},computed:{units:function(){return v.a.unitList.map(function(t){return{flag:t[0],named:t[1]}})}},mounted:function(){this.loadTag()},methods:{locationData:function(t){if(null!=t&&void 0!=t){if(this.named=t.named,this.price=t.price,this.unit=t.unit,this.num=t.num,this.select=[],this.orderNum=t.num,null!=t.tag&&void 0!=t.tag){var e=[],a=!0,n=!1,s=void 0;try{for(var r,o=T()(t.tag);!(a=(r=o.next()).done);a=!0){var l=r.value;e.push(l.id)}}catch(t){n=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(n)throw s}}var c=!0,u=!1,d=void 0;try{for(var h,p=T()(this.tags);!(c=(h=p.next()).done);c=!0){var v=h.value;i.a.inList(v.id,e)&&this.select.push(v.id)}}catch(t){u=!0,d=t}finally{try{!c&&p.return&&p.return()}finally{if(u)throw d}}}this.activeId=t.id}},loadTag:function(){var t=this;n.a.tag.getList_Tag({},!0).then(function(e){n.a.judge_response(e)&&(t.tags=e,t.select.push(e[0].id))})},inList:function(t,e){return i.a.inList(t,e)},tagChoise:function(t){var e=i.a.indexList(t,this.select);e>=0?this.select.length<=1?i.a.showToast("提示：請至少選擇壹個標簽。"):this.select.splice(e,1):this.select.push(t)},tipClose:function(t){var e=this;setTimeout(function(){"num"==t?e.tip_num="":"named"==t?e.tip_named="":"price"==t&&(e.tip_price="")},4200)},tipForm:function(t,e){var a="";1!=t&&(a=t),"num"==e?this.tip_num=a:"named"==e?this.tip_named=a:"price"==e&&(this.tip_price=a),this.tipClose(e)},validateForm:function(){var t=!0,e=M.a.val_empty(this.num,"貨號");return 1==e?(e=M.a.val_char(this.num,"貨號"),this.tipForm(e,"num")):this.tipForm(e,"num"),1!=e&&(t=!1),1==(e=M.a.val_empty(this.named,"描述"))?(e=M.a.val_char(this.named,"描述"),this.tipForm(e,"named")):this.tipForm(e,"named"),1!=e&&(t=!1),1==(e=M.a.val_empty(this.price,"零售價"))?(e=M.a.val_char_price(this.price,"零售價"),this.tipForm(e,"price")):this.tipForm(e,"price"),1!=e&&(t=!1),t},_validateSame:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a={num:t.num};return new $.a(function(t,s){n.a.freight.getList_Freight(a,!0).then(function(a){if(a.length>0)if(0==e)t(!1);else{var i=[],n=!0,s=!1,r=void 0;try{for(var o,l=T()(a);!(n=(o=l.next()).done);n=!0){var c=o.value;c.id!=e&&i.push(c)}}catch(t){s=!0,r=t}finally{try{!n&&l.return&&l.return()}finally{if(s)throw r}}i.length>0&&t(!1)}t(!0)}).catch(function(t){s(!1),i.a.showToast("網絡連接失敗。")})})},_submit:function(t){var e=this;this.isPlus?this._validateSame(t).then(function(a){a?e.$emit("plus_Father",t):i.a.showToast("已存在相同貨號的產品了。")}):this._validateSame(t,this.activeId).then(function(a){a?e.$emit("update_Father",t,e.activeId):i.a.showToast("這個貨號的產品已經存在了。")})},submitForm:function(){if(1==this.validateForm()){var t={num:this.num,named:this.named,price:this.price,unit:this.unit,tags:this.select.join(",")};this._submit(t)}}}},V={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-form-wrapper"},[a("form",[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"num"}},[t._v("貨號")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.num,expression:"num"}],staticClass:"form-control",attrs:{type:"text",id:"num",placeholder:"貨號"},domProps:{value:t.num},on:{input:function(e){e.target.composing||(t.num=e.target.value)}}}),t._v(" "),a("small",{staticClass:"form-text text-muted",attrs:{id:"numTip"}},[t._v(t._s(t.tip_num))])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"named"}},[t._v("描述")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.named,expression:"named"}],staticClass:"form-control",attrs:{type:"text",id:"named",placeholder:"描述"},domProps:{value:t.named},on:{input:function(e){e.target.composing||(t.named=e.target.value)}}}),t._v(" "),a("small",{staticClass:"form-text text-muted",attrs:{id:"numTip"}},[t._v(t._s(t.tip_named))])]),t._v(" "),a("div",{staticClass:"form-group row"},[a("div",{staticClass:"col-sm-4"},[a("label",{attrs:{for:"price"}},[t._v("零售價")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.price,expression:"price"}],staticClass:"form-control",attrs:{type:"text",id:"price",placeholder:"價格"},domProps:{value:t.price},on:{input:function(e){e.target.composing||(t.price=e.target.value)}}}),t._v(" "),a("small",{staticClass:"form-text text-muted",attrs:{id:"numTip"}},[t._v(t._s(t.tip_price))])]),t._v(" "),a("div",{staticClass:"col-sm-4"},[a("label",{attrs:{for:"unit"}},[t._v("單位")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.unit,expression:"unit"}],staticClass:"form-control",attrs:{id:"unit"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.unit=e.target.multiple?a:a[0]}}},t._l(t.units,function(e){return a("option",{key:e.flag,domProps:{value:e.flag}},[t._v(t._s(e.named))])}),0)]),t._v(" "),a("div",{staticClass:"col-sm-4"})]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"named"}},[t._v("標簽")]),t._v(" "),t.tags.length>0?a("div",{staticClass:"tag-wrapper"},t._l(t.tags,function(e){return a("div",{key:e.named,staticClass:"tag tag-def d-inline hand",class:{"tag-active":t.inList(e.id,t.select)},on:{click:function(a){return t.tagChoise(e.id)}}},[t._v("\n          "+t._s(e.named)+"\n        ")])}),0):t._e(),t._v(" "),a("small",{staticClass:"form-text text-muted",attrs:{id:"numTip"}},[t._v(t._s(t.tip_tag))])])])])},staticRenderFns:[]};var O=a("VU/8")(N,V,!1,function(t){a("dKQC")},"data-v-555ce4c4",null).exports,I={components:{FreightPlusForm:O},name:"FreightPlus",props:{freight:{type:Object}},methods:{submitFreightPlus:function(){this.$refs.plusForm.submitForm()},_signelRefreash:function(){this.$emit("signelRefreash_Father")},_plus:function(t){var e=this;n.a.freight.add(t).then(function(t){n.a.judge_response(t)&&(i.a.showToast("新增成功！！！",2100),setTimeout(function(){i.a.closeAllModal(),e._signelRefreash()},700))})}}},S={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal fade",attrs:{tabindex:"-1",role:"dialog",id:"freightPlusModal"}},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-body"},[e("freight-plus-form",{ref:"plusForm",attrs:{isPlus:!0,_freight:this.freight},on:{plus_Father:this._plus}})],1),this._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-main",on:{click:this.submitFreightPlus}},[this._v("保存")])])])])])},staticRenderFns:[]};var j=a("VU/8")(I,S,!1,function(t){a("vd5b")},"data-v-4a79f6b2",null).exports,B={name:"FreightUpdated",components:{FreightPlusForm:O},props:{freight:{type:Object}},methods:{submitFreightPlus:function(){this.$refs.updateFormREF.submitForm()},validateSame:function(t){return!0},update:function(t,e){var a=this;this.validateSame(t)&&n.a.freight.update(t,e).then(function(t){n.a.judge_response(t)&&(i.a.showToast("修改成功！！！",1900),setTimeout(function(){i.a.closeAllModal(),a.$emit("signelRefreash_Father")},700))})},locationUpdateData:function(t){this.$refs.updateFormREF.locationData(t)}}},A={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal fade",attrs:{tabindex:"-1",role:"dialog",id:"freightUpdateModal"}},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-body"},[e("freight-plus-form",{ref:"updateFormREF",attrs:{isPlus:!1},on:{update_Father:this.update}})],1),this._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-main",on:{click:this.submitFreightPlus}},[this._v("保存")])])])])])},staticRenderFns:[]};var Q=a("VU/8")(B,A,!1,function(t){a("BX0g")},"data-v-09b793aa",null).exports,G={components:{FullHeightLayout:r.a,FreightViewTop:h,FreightViewBody:F,FreightViewSearch:b.a,FreightViewFooter:w,Trash:P.a,Empty:x.a,Loading:L.a,PlusFixed:k,FreightPlus:j,FreightUpdated:Q},name:"FreightView",data:function(){return{freightList:[],pageLink:{next:"",previous:"",count:0,offsetNow:0,limit:100},isLoading:!0,activeId:0,activeFreight:null,activeURL:""}},mounted:function(){this.loadData()},methods:{loadData:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null==t&&(t=s.a.buildFirstPagerUrl(n.a.freight.url,a,{offset:0,limit:this.pageLink.limit})),n.a.freight.getListPage(t).then(function(a){e.activeURL=t,e.freightList=a.results,e.pageLink=s.a.buildPageLink(t,a.count,100,a.next,a.previous),e.isLoading=!1}).catch(function(t){i.a.showToast("網絡連接失敗。")})},plusDone:function(){i.a.showModal("freightPlusModal")},locationUpdateData:function(){this.loadData(this.activeURL)},clearFilter:function(){this.loadData()},option:function(t,e){var a=this;this.activeId=t,"trash"==e?i.a.showModal("trashModal"):"update"==e&&n.a.freight.getOne(t).then(function(t){n.a.judge_response(t)&&(a.activeFreight=t,a.$refs.freightUpdateREF.locationUpdateData(t),i.a.showModal("freightUpdateModal"))})},_trash:function(){var t=this,e=this;i.a.closeModal("trashModal"),null!=this.activeId&&this.activeId>0&&n.a.freight.trash(this.activeId).then(function(a){n.a.judge_response(a)&&(i.a.showToast("刪除成功！！"),i.a.hideEle("freight_tr_"+t.activeId),e.isLoading=!1)})}}},H={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("full-height-layout",[a("div",{attrs:{slot:"layout_title"},slot:"layout_title"},[t._v("產品")]),t._v(" "),a("freight-view-top",{attrs:{slot:"layout_inner_head",freights:t.freightList},on:{clearFilter_Father:t.clearFilter},slot:"layout_inner_head"}),t._v(" "),t.freightList.length>0?a("freight-view-body",{attrs:{slot:"layout_inner_body",freights:t.freightList},on:{option_Father:t.option},slot:"layout_inner_body"}):t.isLoading?a("loading",{attrs:{slot:"layout_inner_body"},slot:"layout_inner_body"}):a("empty",{attrs:{slot:"layout_inner_body"},slot:"layout_inner_body"}),t._v(" "),a("freight-view-footer",{attrs:{slot:"layout_footer",_pageLink:t.pageLink},on:{_loadData_Father:t.loadData},slot:"layout_footer"}),t._v(" "),a("div",{attrs:{slot:"layout_extra"},slot:"layout_extra"},[a("freight-view-search",{on:{loadData_Father:t.loadData}}),t._v(" "),a("trash",{on:{trashItem:t._trash}}),t._v(" "),a("plus-fixed",{on:{plusDone_Father:t.plusDone}}),t._v(" "),a("freight-plus",{on:{signelRefreash_Father:t.loadData}}),t._v(" "),a("freight-updated",{ref:"freightUpdateREF",attrs:{freight:t.activeFreight},on:{signelRefreash_Father:t.locationUpdateData}})],1)],1)},staticRenderFns:[]};var K=a("VU/8")(G,H,!1,function(t){a("tbEl")},"data-v-93d9ec32",null);e.default=K.exports},dKQC:function(t,e){},e1Ak:function(t,e){},gIGi:function(t,e,a){"use strict";a("NAQQ");var i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn btn-light btn-sm pb-0 float-right mr-2 tool-tip",attrs:{"data-toggle":"tooltip","data-placement":"top",title:"重新整理"},on:{click:this.clearCondition}},[e("i",{staticClass:"fa fa-refresh"})])},staticRenderFns:[]};var n=a("VU/8")({name:"ClearFilterOption",methods:{clearCondition:function(){this.$emit("clearCondition_Father")}}},i,!1,function(t){a("xpo1")},"data-v-3a774582",null);e.a=n.exports},gtvN:function(t,e){},"s/GW":function(t,e){},tbEl:function(t,e){},vd5b:function(t,e){},xpo1:function(t,e){}});
//# sourceMappingURL=4.76dc2f9c5fd99a86abc7.js.map