webpackJsonp([10],{B04Z:function(t,e){},fiGY:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i("5nBN");var a=i("wYMm"),s=i("NAQQ"),n=i("/xUl"),o=i("gS0T"),r={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h5",{staticClass:"fw-none mt-2"},[t._v("\n    全部\n  ")]),t._v(" "),i("table",{staticClass:"table m-0"},[i("tr",{staticClass:"text-left"},[i("td",{staticClass:"text-accent",attrs:{width:"6%"}},[t._v("#")]),t._v(" "),i("td",{attrs:{width:"10%"}},[t._v("報價單號")]),t._v(" "),i("td",{attrs:{width:"20%"}},[t._v("所屬客戶")]),t._v(" "),i("td",{attrs:{width:"15%"}},[t._v("報價日期")]),t._v(" "),i("td",{staticClass:"text-center",attrs:{width:"11%"}},[t._v("付款期限")]),t._v(" "),i("td",{staticClass:"text-center",attrs:{width:"10%"}},[t._v("產品數量")]),t._v(" "),i("td",{staticClass:"text-center",attrs:{width:"10%"}},[t._v("Pdf 文件")]),t._v(" "),i("td",{staticClass:"text-center",attrs:{width:"13%"}})])])])}]};var c=i("VU/8")({name:"PricesViewTop"},r,!1,function(t){i("o9rZ")},"data-v-a3b47bce",null).exports,d=i("z8RL"),l=i("SiM+"),m=i("uT2u"),u={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"copy-option hand tool-tip",attrs:{"data-toggle":"tooltip","data-placement":"top",title:"復製一份"}},[e("i",{staticClass:"fa fa-clone"})])}]};var _=i("VU/8")({name:"Remove"},u,!1,function(t){i("nV1E")},null,null).exports,p={name:"PricesViewBody",components:{Pencil:d.a,Remove:l.a,CustomModal:m.a,CopyOption:_},props:{prices:{type:Array}},data:function(){return{activeId:0}},methods:{ser_timed:function(t){return s.a.timed.ser_timed(t,!0,!0)},ser_timed_now_month:function(t,e){s.a.timed.is_now_month(t);return""},option:function(t,e){this.activeId=t,"update"!=e?this.$emit("option_Father",t,e):this.done()},pdfView:function(t){this.$emit("pdfView_Father",t)},showTip:function(){s.a.showToast("該報價單是屬於今月份的。")},done:function(){this.$emit("option_Father",this.activeId,"update")}}},h={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("table",{staticClass:"table m-0 table-top-line-none"},[i("tbody",t._l(t.prices,function(e,a){return i("tr",{key:e.id,staticClass:"text-left"},[i("td",{staticClass:"text-accent",attrs:{width:"6%"}},[t._v(t._s(a+1))]),t._v(" "),i("td",{attrs:{width:"10%"}},[t._v(t._s(e.num))]),t._v(" "),i("td",{attrs:{width:"20%"}},[t._v(t._s(e.membery.num)+" "+t._s(e.membery.named))]),t._v(" "),i("td",{attrs:{width:"15%"}},[t._v("\n          "+t._s(t.ser_timed(e.start_time))+"\n          "),i("div",{staticClass:"tip-wrapper tip-pos-fix animate-shake hand",domProps:{innerHTML:t._s(t.ser_timed_now_month(e.start_time,e.id))},on:{click:t.showTip}})]),t._v(" "),i("td",{staticClass:"text-center",attrs:{width:"11%"}},[t._v(t._s(e.pay_time.named))]),t._v(" "),i("td",{staticClass:"text-center",attrs:{width:"10%"}},[t._v(t._s(e.freight_num))]),t._v(" "),i("td",{staticClass:"text-center hand",attrs:{width:"10%"},on:{click:function(i){return t.pdfView(e.id)}}},[t._v("查看")]),t._v(" "),i("td",{staticClass:"text-center",attrs:{width:"13%"}},[i("i",{staticClass:"float-right",on:{click:function(i){return t.option(e.id,"trash")}}},[i("remove")],1),t._v(" "),i("i",{staticClass:"float-right",on:{click:function(i){return t.option(e.id,"update")}}},[i("pencil")],1),t._v(" "),i("i",{staticClass:"float-right",on:{click:function(i){return t.option(e.id,"copy")}}},[i("copy-option")],1)])])}),0)]),t._v(" "),i("custom-modal",{attrs:{need_cancel:!0,title:"提示",txt:"按修改立即轉到修改頁面",id_prefix:"pricesUpdateSure"},on:{done_Father:t.done}},[i("div",{attrs:{slot:"submit_text"},slot:"submit_text"},[t._v("立即跳轉")])])],1)},staticRenderFns:[]};var v=i("VU/8")(p,h,!1,function(t){i("yDeG")},"data-v-01a6a0c8",null).exports,f=i("HT3s"),y=i("U5hB"),b=i("nN2X"),C=i("cpG1"),w={name:"",data:function(){return{active_pc:null,active_num:null,active_time:null}},props:{},methods:{valideSame:function(t){var e=this;t&&n.a.prices.getList_Prices({num:t},!0).then(function(t){t.length>0?s.a.showToast("已存在相同的報價單編號！！！"):e.plusPrice()})},copy:function(t,e,i){this.active_pc=t,this.active_num=e,this.active_time=i,this.valideSame(e)},plusPrice:function(){var t=this,e=this.active_pc.price_collect;e.num=this.active_num,e.membery_id=e.membery.id,e.start_time=this.active_time+" 00:00:00",e.pay_time_id=e.pay_time.id,delete e.id,delete e.membery,delete e.add_time,delete e.end_time,delete e.pay_time,n.a.prices.add(e).then(function(e){n.a.judge_response(e)&&n.a.prices_content.add({price_collect_id:e.id,content:t.active_pc.content}).then(function(e){n.a.judge_response(e)&&(s.a.showToast("報價單復製成功！！！"),s.a.closeAllModal(),t.$emit("refresh_Father"))})})}}},g={render:function(){var t=this.$createElement;return(this._self._c||t)("div")},staticRenderFns:[]};var x=i("VU/8")(w,g,!1,function(t){i("rIBN")},"data-v-c0d0ab4a",null).exports,P=(i("ryLw"),i("3MUH"),i("I76R")),F=i.n(P),I={components:{PricesCopy:x},name:"SubmitModal",data:function(){return{num:"",tip_num:"",timed:"",tip_timed:"",activeId:null,activePc:null,price_num:"",member_name:""}},props:{},methods:{loadCopy:function(t){this.activeId=t,this.loadPriceCollect(),console.log("load Copy"),s.a.showModal("copyPriceInputModal")},sureSubmit:function(){this.validateForm()&&this.$refs.copyDoREF.copy(this.activePc,this.num,this.timed)},tipClose:function(t){var e=this;setTimeout(function(){"num"==t&&(e.tip_num=""),"timed"==t&&(e.tip_timed="")},4200)},tipForm:function(t,e){var i="";1!=t&&(i=t),"num"==e&&(this.tip_num=i),"timed"==e&&(this.tip_timed=i),this.tipClose(e)},validateForm:function(){var t=!0,e=F.a.val_empty(this.num,"報價單號");return 1==e?(e=F.a.val_char(this.num,"報價單號"),this.tipForm(e,"num")):this.tipForm(e,"num"),1!=e&&(t=!1),1==(e=F.a.val_empty(this.timed,"現付款期限"))?(e=F.a.val_timed(this.timed,"現付款期限"),this.tipForm(e,"timed")):this.tipForm(e,"timed"),1!=e&&(t=!1),this.num==this.price_num&&(this.tipForm("請填寫不同的報價單號","num"),t=!1),s.a.timed.ser_timed(this.activePc.price_collect.start_time,!1,!0)==s.a.timed.ser_timed(this.timed,!1,!0)&&(this.tipForm("請填寫不同的付款期限","timed"),t=!1),t},loadPriceCollect:function(){var t=this;this.activeId&&n.a.prices_content.getOneByPrices({price_collect:this.activeId}).then(function(e){if(e.length>0){t.activePc=e[0];var i=t.activePc.price_collect;t.num=i.num,t.timed=s.a.timed.ser_timed(i.start_time,!1,!0),t.price_num=i.num,t.member_name=i.membery.num+" "+i.membery.named}}).catch(function(t){s.a.showToast("網絡連接失敗。")})},refresh:function(){this.$emit("refresh_Father")}}},M={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"modal fade",attrs:{id:"copyPriceInputModal","data-keyboard":"false",tabindex:"-1",role:"dialog","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"}},[i("div",{staticClass:"modal-dialog modal-dialog-centered"},[i("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"modal-form-wrapper"},[i("form",[i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"num"}},[t._v("所屬客戶")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.member_name,expression:"member_name"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:t.member_name},on:{input:function(e){e.target.composing||(t.member_name=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"num"}},[t._v("原報價單號")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.price_num,expression:"price_num"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:t.price_num},on:{input:function(e){e.target.composing||(t.price_num=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"form-group"},[t._m(1),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.num,expression:"num"}],staticClass:"form-control",attrs:{type:"text",id:"num",placeholder:"報價單號"},domProps:{value:t.num},on:{input:function(e){e.target.composing||(t.num=e.target.value)}}}),t._v(" "),i("small",{staticClass:"form-text text-muted",attrs:{id:"numTip"}},[t._v(t._s(t.tip_num))])]),t._v(" "),i("div",{staticClass:"form-group"},[t._m(2),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.timed,expression:"timed"}],staticClass:"form-control",attrs:{type:"text",id:"timed",placeholder:"yyyy-mm-dd"},domProps:{value:t.timed},on:{input:function(e){e.target.composing||(t.timed=e.target.value)}}}),t._v(" "),i("small",{staticClass:"form-text text-muted",attrs:{id:"numTip"}},[t._v(t._s(t.tip_timed))])])])]),t._v(" "),i("prices-copy",{ref:"copyDoREF",on:{refresh_Father:t.refresh}})],1),t._v(" "),i("div",{staticClass:"modal-footer"},[i("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("取消")]),t._v(" "),i("button",{staticClass:"btn btn-main",attrs:{type:"button"},on:{click:t.sureSubmit}},[t._v("確認復製")])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title",attrs:{id:"staticBackdropLabel"}},[this._v("復製報價單")]),this._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:"num"}},[this._v("\n                          現報價單號 "),e("span",{staticClass:"txt-danger"},[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:"num"}},[this._v("\n                          現付款期限 "),e("span",{staticClass:"txt-danger"},[this._v("*")])])}]};var T=i("VU/8")(I,M,!1,function(t){i("j/FK")},"data-v-d8cc1ba6",null).exports,L={components:{FullHeightLayout:o.a,PricesViewTop:c,PricesViewBody:v,Empty:C.a,Loading:y.a,Trash:f.a,PricesPdfModal:b.a,CustomModal:m.a,PricesCopy:x,PricesCopyModal:T},name:"PricesView",data:function(){return{pricesList:[],activeId:0,activePrices:{},isLoading:!0}},mounted:function(){this.loadData()},methods:{refresh:function(){this.isLoading=!0,this.pricesList=[],this.loadData()},loadData:function(){var t=this;setTimeout(function(){n.a.prices.getList_Prices({},!0).then(function(e){t.isLoading=!1,t.pricesList=e}).catch(function(t){s.a.showToast("網絡連接失敗。")})},a.a.delayTime)},ser_timed:function(t){return s.a.timed.ser_timed(t,!0,!0)},option:function(t,e){var i=this;this.activeId=t,"update"==e?n.a.prices_content.getOneByPrices({price_collect:t}).then(function(t){n.a.judge_response_list(t)?i.$router.push({path:"/home/prices_update",query:{priceContentId:t[0].id}}):s.a.showToast("該數據已過期！！！")}).catch(function(t){s.a.showToast("網絡連接失敗。")}):"trash"==e?s.a.showModal("trashModal"):"copy"==e&&this.copyItem()},pdfView:function(t){this.activePrices=this.pricesList.filter(function(e){return e.id==t})[0],this.$refs.pdfModal.collectData(this.activePrices),s.a.showModal("pricesPdfViewModal")},copyItem:function(){this.$refs.copyREF.loadCopy(this.activeId)},_trash:function(){var t=this;s.a.closeModal("trashModal"),null!=this.activeId&&this.activeId>0&&n.a.prices.trash(this.activeId).then(function(e){if(n.a.judge_response(e)){e.id;s.a.showToast("刪除成功！！"),t.isLoading=!0,t.loadData()}})}}},V={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("full-height-layout",[i("div",{attrs:{slot:"layout_title"},slot:"layout_title"},[t._v("報價單")]),t._v(" "),i("prices-view-top",{attrs:{slot:"layout_inner_head"},slot:"layout_inner_head"}),t._v(" "),this.pricesList.length>0?i("prices-view-body",{attrs:{slot:"layout_inner_body",prices:t.pricesList},on:{pdfView_Father:t.pdfView,option_Father:t.option},slot:"layout_inner_body"}):t.isLoading?i("transition",{attrs:{slot:"layout_inner_body",name:"fade"},slot:"layout_inner_body"},[i("loading")],1):i("empty",{attrs:{slot:"layout_inner_body"},slot:"layout_inner_body"}),t._v(" "),i("div",{attrs:{slot:"layout_extra"},slot:"layout_extra"},[i("trash",{on:{trashItem:t._trash}}),t._v(" "),i("prices-pdf-modal",{ref:"pdfModal",attrs:{the_member:null,the_prices_timed:null,the_prices_numed:null,the_prices_content:[],the_prices_paytime:null,isPrint:!0}}),t._v(" "),i("prices-copy-modal",{ref:"copyREF",on:{refresh_Father:t.refresh}})],1)],1)},staticRenderFns:[]};var $=i("VU/8")(L,V,!1,function(t){i("B04Z")},"data-v-238f4706",null);e.default=$.exports},"j/FK":function(t,e){},nV1E:function(t,e){},o9rZ:function(t,e){},rIBN:function(t,e){},yDeG:function(t,e){}});
//# sourceMappingURL=10.f59f6e241fbb0fe343e2.js.map